
<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Planner - Job Assignments</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; }
    th { background: #003366; color: white; }
    select, input { margin-right: 10px; padding: 0.5rem; }
  </style>
</head>
<body>
  <h2>ðŸ“‹ Job Assignments</h2>
  <label>Technician:</label>
  <select id="filterTech"><option value="">All</option></select>
  <label>Date:</label>
  <input type="date" id="filterDate" />
  <label>Status:</label>
  <select id="filterStatus">
    <option value="">All</option><option>Assigned</option><option>In Progress</option><option>Completed</option>
  </select>
  <button onclick="applyFilters()">Apply</button>

  <table id="jobTable">
    <thead><tr><th>Vehicle</th><th>Technician</th><th>Date</th><th>Status</th></tr></thead>
    <tbody></tbody>
  </table>

<script>
  const jobSheetUrl = "https://sheetdb.io/api/v1/xg2dgvssxzvag"; // Replace if needed

  async function loadJobs() {
    const res = await fetch(jobSheetUrl);
    const data = await res.json();
    populateTable(data);
    populateTechnicians(data);
  }

  function populateTable(data) {
    const tbody = document.querySelector("#jobTable tbody");
    tbody.innerHTML = "";
    data.forEach(job => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${job.VehicleNo}</td><td>${job.FullName}</td><td>${job.Date || ""}</td><td>${job.Status}</td>`;
      tbody.appendChild(tr);
    });
  }

  function populateTechnicians(data) {
    const techSelect = document.getElementById("filterTech");
    const names = [...new Set(data.map(j => j.FullName))];
    names.forEach(n => {
      const opt = document.createElement("option");
      opt.value = n; opt.text = n;
      techSelect.appendChild(opt);
    });
  }

  function applyFilters() {
    const tech = document.getElementById("filterTech").value;
    const date = document.getElementById("filterDate").value;
    const status = document.getElementById("filterStatus").value;

    fetch(jobSheetUrl).then(res => res.json()).then(data => {
      const filtered = data.filter(j =>
        (!tech || j.FullName === tech) &&
        (!date || j.Date === date) &&
        (!status || j.Status === status)
      );
      populateTable(filtered);
    });
  }

  loadJobs();
</script>
</body></html>
